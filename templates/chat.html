{% extends 'layout.html' %}
{% block style %}
	<style type="text/css">
		.chats {
			height: 300px;
			overflow: scroll;
			list-style: none;
			margin: 0;
			padding: 0;
		}		
		.chats li {
			display: inline-block;
			clear: both;
			padding: 20px;
 			border-radius: 30px;
	  		margin-bottom: 2px;
		}
		.him{
		  background: #eee;
		  float: left;
		}

		.me{
		  float: right;
		  background: #0084ff;
		  color: #fff;
		}

		.him + .me{
		  border-bottom-right-radius: 5px;
		}

		.me + .me{
		  border-top-right-radius: 5px;
		  border-bottom-right-radius: 5px;
		}
		.me + .him {
			border-bottom-left-radius: 5px;	
		}

		.him:last-of-type {
			border-bottom-left-radius: 30px;	
		}

		.me:last-of-type {
		  border-bottom-right-radius: 30px;
		}
		
	</style>
{% endblock style %}
{% block content %}
<div class="ui stackable grid container" style="padding-top: 10em;">
	{{ session }}
	<div class="four wide column" style="border: 4px solid black; min-height: 400px; text-align: center;">
		<h1>Users</h1>
		<ul id="usersList">
			
		</ul>
	</div>
	<div class="twelve wide column"  style="min-height: 400px; border: 4px solid black; text-align: center;">
		<h1>Chats</h1>
		<ul class="chats">
			<li class="him">
				<div class="owner">
					wyvern
				</div>
				<div class="message">
					A
				</div>
			</li>
			<li class="me">
				B
			</li>
			<li class="me">
				C
			</li>
			<li class="me">
				D
			</li>
			<li class="him">
				E
			</li>
			<li class="me">
				F
			</li>
			<li class="him">
				G
			</li>
		</ul>
		<div class="ui form" id="message_input">
			<div class="ui field">
				<input type="text" name="message" placeholder="Place chat here...">
				<button class="ui green button">Send</button>
			</div>
		</form>
	</div>
</div>
{% endblock content %}
{% block script %}
<script type="text/javascript">
	let socket = io.connect('http://' + document.domain + ':' + location.port);
	let user_list = $('ul#usersList');
	socket.on('connect', function(){
		console.log("Connected")
		socket.emit('request_users');
	})
	socket.on('list_users', function(message){
		console.dir(message);
		let users = message;
		user_list.empty();
		for(user of users){
			user_list.append('<li>' + user.username + '</li>');
		}
	})
</script>
{% endblock script %}